<% content_for :title, "Mes notifications" %>

<div class="container py-5" style="max-width: 800px; margin-top: 100px;">

  <!-- Titre principal -->
  <h1 class="text-center fw-bold mb-5 text-black" style="font-size: 2rem;">Mes notifications</h1>

  <% if @notifications.any? %>
    <div class="list-group rounded-4 shadow-sm overflow-hidden">

      <% @notifications.each do |notification| %>
        <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-start <%= notification.read ? '' : 'bg-light' %> p-3 border-bottom">

          <div class="me-auto text-dark">
            <strong>
              <%= link_to notification.actor.username, user_path(notification.actor), class: "text-decoration-none text-dark" %>
            </strong>

            <span class="ms-1">
              <% case notification.action %>
              <% when "liked" %>
                a aimé votre chronique
              <% when "commented" %>
                a commenté votre chronique
              <% when "followed" %>
                a commencé à vous suivre
              <% else %>
                a effectué une action
              <% end %>
            </span>

            <% path =
              case notification.notifiable
              when Comment
                chronicle_path(notification.notifiable.chronicle)
              else
                polymorphic_path(notification.notifiable)
              end
            %>

            <%= link_to "→ Voir", path, class: "text-decoration-none fw-semibold ms-2" %>
          </div>

          <small class="text-muted">il y a <%= time_ago_in_words(notification.created_at) %></small>
        </div>
      <% end %>

    </div>

    <!-- Marquer toutes comme lues -->
    <div class="text-center mt-4">
        <%= button_to "Marquer toutes comme lues", "/notifications/mark_as_read", method: :patch, class: "btn btn-outline-dark rounded-pill px-4 py-2 fw-semibold" %>
    </div>

  <% else %>
    <div class="alert alert-secondary text-center mt-5">
      Vous n’avez aucune notification pour le moment.
    </div>
  <% end %>

</div>
