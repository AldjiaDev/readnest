<div class="col-md-4 mb-4">
  <div class="card h-100 shadow-sm border-0">

    <% if chronicle.photo.attached? %>
      <%= link_to chronicle_path(chronicle) do %>
        <%= image_tag chronicle.photo, class: "card-img-top", style: "height: 300px; object-fit: cover;" %>
      <% end %>
    <% end %>

    <div class="card-body d-flex flex-column">
      <p class="text-muted small mb-1">
        <%= chronicle.created_at.strftime("%d %b %Y") %> · par <%= chronicle.user.username %>
      </p>

      <h5 class="card-title fw-bold mb-2" style="font-size: 1.1rem;">
        <%= link_to truncate(chronicle.title, length: 70), chronicle_path(chronicle), class: "text-decoration-none text-dark" %>
      </h5>

      <p class="card-text text-muted small mb-3">
        <%= truncate(strip_tags(chronicle.content), length: 100) %>
      </p>

      <%= link_to "Lire la chronique", chronicle_path(chronicle), class: "btn btn-outline-primary btn-sm mt-auto w-100" %>

      <% if user_signed_in? && current_user == chronicle.user %>
        <%= button_to "🗑️ Supprimer", chronicle_path(chronicle),
            method: :delete,
            data: { confirm: "Supprimer cette chronique ?" },
            class: "btn btn-outline-danger btn-sm mt-2 w-100" %>
      <% end %>
    </div>
  </div>
</div>
