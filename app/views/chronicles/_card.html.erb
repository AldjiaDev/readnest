<div class="col-md-4 mb-4">
  <div class="card h-100 shadow-sm border-0" style="aspect-ratio: 2 / 3; overflow: hidden;">

    <% if chronicle.photo.attached? %>
      <%= link_to chronicle_path(chronicle) do %>
        <%= image_tag chronicle.photo, class: "card-img-top", style: "height: 65%; object-fit: cover;" %>
      <% end %>
    <% else %>
      <div class="bg-secondary bg-opacity-10 d-flex align-items-center justify-content-center" style="height: 65%;">
        <span class="text-muted small">Aucune image</span>
      </div>
    <% end %>

    <div class="card-body d-flex flex-column p-3">
      <p class="text-muted small mb-1">
        <%= chronicle.created_at.strftime("%d %b %Y") %> · par <%= chronicle.user.username %>
      </p>

      <h5 class="card-title fw-bold mb-2" style="font-size: 1.1rem;">
        <%= link_to truncate(chronicle.title, length: 60), chronicle_path(chronicle), class: "text-decoration-none text-dark" %>
      </h5>

      <ul class="list-unstyled small text-muted mb-2">
        <% if chronicle.book_title.present? %>
          <li><strong>Livre :</strong> <%= chronicle.book_title %></li>
        <% end %>
        <% if chronicle.author.present? %>
          <li><strong>Auteur·e :</strong> <%= chronicle.author %></li>
        <% end %>
        <% if chronicle.publisher.present? %>
          <li><strong>Éditeur :</strong> <%= chronicle.publisher %></li>
        <% end %>
      </ul>

      <p class="card-text text-muted small mb-3">
        <%= truncate(strip_tags(chronicle.content), length: 80) %>
      </p>

      <%= link_to "Lire la chronique", chronicle_path(chronicle), class: "btn btn-outline-primary btn-sm mt-auto w-100" %>
    </div>
  </div>
</div>
